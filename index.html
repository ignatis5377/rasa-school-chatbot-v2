<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Ο Ψηφιακός βοηθός του σχολείου</title>
    <style>
        body {
            font-family: sans-serif;
            background-color: #eee;
        }
    </style>
</head>

<body>
    <h1>Testing Chatbot Connection...</h1>
    <p>Open the chat widget at the bottom right.</p>

    <script>!(function () {
            let e = document.createElement("script"),
                t = document.head || document.getElementsByTagName("head")[0];
            (e.src = "https://cdn.jsdelivr.net/npm/rasa-webchat@1.0.1/lib/index.js"),
                (e.async = !0),
                (e.onload = () => {
                    window.WebChat.default(
                        {
                            selector: "#webchat",
                            initPayload: "/greet",
                            customData: { "language": "el" },
                            socketUrl: "https://104.155.53.205.nip.io",
                            socketPath: "/socket.io/",
                            title: "Ο Ψηφιακός βοηθός του σχολείου",
                            subtitle: "Ρώτησέ με ό,τι θες!",
                            storage: "session",
                            tooltip: "Ο Ψηφιακός βοηθός του σχολείου",
                            tooltipDelay: 500,
                            withRules: true,
                            initiallyOpen: true,
                        },
                        null
                    );

                    // Workaround: Force open if initiallyOpen fails
                    setTimeout(function () {
                        const launcher = document.querySelector('.rw-launcher');
                        // Check if launcher exists and if the conversation container is NOT already visible
                        const conversation = document.querySelector('.rw-conversation-container');
                        if (launcher && !conversation) {
                            console.log("Force opening chat widget...");
                            launcher.click();
                        }
                    }, 2000); // Wait 2s to ensure widget is loaded
                }),
                t.insertBefore(e, t.firstChild);
        })();
    </script>
</body>

</html>