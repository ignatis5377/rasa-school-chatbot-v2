# Οδηγός Λειτουργίας Αποθετηρίου (Repository System Guide)

Αυτό το έγγραφο περιγράφει αναλυτικά την τεχνική υλοποίηση, τα εργαλεία και τη ροή εργασίας για το σύστημα διαχείρισης και αποθήκευσης εκπαιδευτικού υλικού (Ερωτήσεις/Ασκήσεις) του Chatbot.

## 1. Τεχνολογίες και Εργαλεία

Η λειτουργία του αποθετηρίου έχει υλοποιηθεί με χρήση των παρακάτω τεχνολογιών και βιβλιοθηκών:

*   **Rasa Framework (Python)**: Ο πυρήνας της λογικής του chatbot. Μέσω των **Custom Actions**, διαχειρίζεται τα αιτήματα των χρηστών για μεταφόρτωση αρχείων και δημιουργία διαγωνισμάτων.
*   **SQLite**: Η βάση δεδομένων που αποθηκεύει το κείμενο των ερωτήσεων, τις απαντήσεις τους και τα μεταδεδομένα (τάξη, δυσκολία, μάθημα). Επιλέχθηκε για την απλότητα και την ευκολία μεταφοράς (portable).
*   **Streamlit (Python)**: Χρησιμοποιείται για την εφαρμογή διαχείρισης (`admin_app.py`). Παρέχει ένα γραφικό περιβάλλον (GUI) για τον διαχειριστή, ώστε να προσθέτει χειροκίνητα ερωτήσεις χωρίς να χρειάζεται να γράψει κώδικα ή SQL.
*   **Python Libraries (Βιβλιοθήκες)**:
    *   `sqlite3`: Για την επικοινωνία με τη βάση δεδομένων.
    *   `python-docx`: Για την ανάγνωση και εξαγωγή κειμένου και εικόνων από αρχεία Word (.docx).
    *   `pypdf`: Για την ανάγνωση αρχείων PDF.
    *   `Pillow (PIL)`: Για την επεξεργασία και αποθήκευση εικόνων.

## 2. Αρχιτεκτονική και Τοποθεσίες Αρχείων

Το σύστημα είναι οργανωμένο σε συγκεκριμένους φακέλους για διαχωρισμό κώδικα και δεδομένων.

### 📂 Αποθήκευση Δεδομένων
Εδώ καταλήγουν όλα τα δεδομένα που ανεβάζετε:

| Τύπος Δεδομένων | Τοποθεσία (Path) | Περιγραφή |
| :--- | :--- | :--- |
| **Βάση Δεδομένων** | `data/questions.db` | Εδώ αποθηκεύονται τα κείμενα των ερωτήσεων, οι απαντήσεις, και οι διαδρομές (paths) των εικόνων. |
| **Εικόνες/Σχήματα** | `files/images/` | Εδώ αποθηκεύονται τα αρχεία εικόνων (.png, .jpg) που εξάγονται αυτόματα από τα Word έγγραφα ή ανεβαίνουν μέσω του Admin App. |
| **Αρχεία Εξετάσεων** | `files/generated_exams/` | Εδώ αποθηκεύονται τα PDF διαγωνίσματα που παράγει το Bot για τους μαθητές. |

### 💻 Τοποθεσία Κώδικα
Τα αρχεία που περιέχουν τη λογική του συστήματος:

| Αρχείο | Περιγραφή Λειτουργίας |
| :--- | :--- |
| `actions/actions.py` | Περιέχει όλη τη λογική για το Chatbot. Συγκεκριμένα: <br> - `ActionUploadExamMaterial`: Διαβάζει το αρχείο που ανέβασε ο χρήστης. <br> - `extract_questions_from_docx`: Αναλύει το Word, βρίσκει ερωτήσεις και σώζει εικόνες. <br> - `ActionCreateExamNew`: Επιλέγει τυχαίες ερωτήσεις από τη βάση και φτιάχνει το PDF. |
| `admin_app.py` | Ο κώδικας για το γραφικό περιβάλλον διαχείρισης (Streamlit). Επιτρέπει την απευθείας εισαγωγή ερωτήσεων στη βάση. |
| `actions/server_db_check.py` | Βοηθητικό script για έλεγχο της κατάστασης της βάσης. |

## 3. Διαδικασία Λειτουργίας (Workflow)

Η εισαγωγή υλικού στο σύστημα γίνεται με δύο τρόπους:

### Α. Μέσω του Chatbot (Μαζική Εισαγωγή)
1.  Ο χρήστης (καθηγητής) ανεβάζει ένα αρχείο `.docx` ή `.pdf` στη συνομιλία.
2.  Το Bot καλεί το `ActionUploadExamMaterial`.
3.  Το σύστημα ανοίγει το αρχείο και ψάχνει για μοτίβα κειμένου (π.χ. "Ερώτηση 1:", "Απάντηση:").
4.  **Αυτόματη Εξαγωγή Εικόνων**: Αν το αρχείο `.docx` περιέχει εικόνες, αυτές αποθηκεύονται αυτόματα στον φάκελο `files/images/` με μοναδικό όνομα.
5.  Το κείμενο και η διαδρομή της εικόνας αποθηκεύονται στον πίνακα `questions` της βάσης `questions.db`.

### Β. Μέσω του Admin App (Χειροκίνητη Εισαγωγή)
1.  Ο διαχειριστής ανοίγει την εφαρμογή Admin (`streamlit run admin_app.py`).
2.  Συμπληρώνει τη φόρμα (Μάθημα, Τάξη, Κείμενο, Λύση).
3.  Αν υπάρχει εικόνα, την ανεβάζει από τον υπολογιστή του ("Drag & Drop").
4.  Πατώντας "Αποθήκευση", η εφαρμογή γράφει τα δεδομένα απευθείας στη βάση `questions.db` και σώζει την εικόνα στο `files/images/`.

## 4. Δομή Βάσης Δεδομένων
Ο πίνακας `questions` έχει τις εξής στήλες:

*   `id`: Μοναδικός αριθμός ερώτησης.
*   `subject`: Μάθημα (π.χ. Φυσική).
*   `class_name`: Τάξη (π.χ. Γ Γυμνασίου).
*   `difficulty`: Δυσκολία (εύκολο, μέτριο, δύσκολο).
*   `question_text`: Το κείμενο της εκφώνησης.
*   `answer_text`: Το κείμενο της απάντησης/λύσης.
*   `image_path`: Η διαδρομή του αρχείου εικόνας στον δίσκο (π.χ. `files/images/abc-123.png`), αν υπάρχει.
*   `source_file`: Το όνομα του αρχείου από το οποίο προήλθε η ερώτηση.
