# Οδηγός Ασφάλειας & Διασύνδεσης (Nginx, SSL, WordPress)

Εκτός από τα βασικά (Rasa, Docker, Cloud), υπάρχουν τρεις "αφανείς ήρωες" που κάνουν το σύστημα ασφαλές και λειτουργικό.

---

## 1. Nginx (Ο Τροχονόμος του Server)

Αν το Rasa είναι ο "εγκέφαλος", το **Nginx** είναι ο "πορτιέρης" ή ο "τροχονόμος".

**Τι κάνει:**
1.  **Reverse Proxy:** Παραλαμβάνει τα αιτήματα των χρηστών από το ίντερνετ (Port 80/443) και τα "πασάρει" στο εσωτερικό του Server όπου τρέχει το Rasa (Port 5005).
2.  **CORS Headers:** Ρυθμίζεται ώστε να επιτρέπει αιτήματα *μόνο* από το domain του σχολείου (ignatislask.sites.sch.gr), μπλοκάροντας κακόβουλες σελίδες από το να φορτώσουν το chatbot μας.
3.  **Εξυπηρέτηση Αρχείων:** Σερβίρει γρήγορα τα αρχεία PDF και τις εικόνες (`/files/...`), αποφορτίζοντας την Python.

**Πού βρίσκεται:** Στον φάκελο `nginx/` και ρυθμίζεται στο `docker-compose.yml`.

---

## 2. Certbot (Ο Φύλακας της Ασφάλειας - HTTPS)

Έχετε παρατηρήσει το **λουκετάκι** 🔒 στη γραμμή διευθύνσεων; Αυτό είναι το HTTPS.

**Τι κάνει:**
1.  **Κρυπτογράφηση:** Κρυπτογραφεί τη συνομιλία ώστε κανείς να μην μπορεί να υποκλέψει δεδομένα.
2.  **Let's Encrypt:** Χρησιμοποιούμε την υπηρεσία Let's Encrypt για δωρεάν πιστοποιητικά που ανανεώνονται αυτόματα κάθε μήνα.
3.  **Σημασία για το WordPress:** Επειδή το site του σχολείου είναι HTTPS, το Chatbot *υποχρεωτικά* πρέπει να είναι και αυτό HTTPS (Mixed Content Security Policy). Αν δεν είχαμε το Certbot, το Chatbot δεν θα φόρτωνε καν!

---

## 3. WordPress Integration (Η Αμφίδρομη Γέφυρα)

Η επικοινωνία μεταξύ του Chatbot και του Σχολικού Site είναι πλέον **αμφίδρομη**.

### Α. Από το WordPress προς το Chatbot (Ταυτοποίηση)
Όταν ο χρήστης μπαίνει στη σελίδα:
1.  Ένα PHP script ελέγχει αν είναι συνδεδεμένος (Logged in).
2.  Στέλνει κρυφά στο Chatbot το `initPayload` με τα στοιχεία:
    *   `role`: (student, parent, teacher, admin)
    *   `username`: Το όνομα του χρήστη.
3.  **Αποτέλεσμα:** Το Chatbot ξέρει ποιον έχει απέναντί του και προσαρμόζει τον Χαιρετισμό (Role-Based Greeting) και τα Δικαιώματα (π.χ. Upload μόνο για Teacher/Admin).

### Β. Από το Chatbot προς το WordPress (Αναζήτηση)
Όταν ο χρήστης ρωτάει κάτι (π.χ. "εκδρομή"):
1.  Το Chatbot (Python Action) καλεί το **WordPress REST API** (`/wp/v2/posts`).
2.  **Security Bypass (Trick):** Επειδή πολλά security plugins του WordPress μπλοκάρουν τα bots, ο κώδικάς μας στέλνει έναν **Fake User-Agent** (μιμείται τον Browser Chrome) για να πάρει απάντηση.
3.  **SSL Verification:** Στον κώδικα έχουμε προσθέσει `verify=False` για να αποφύγουμε προβλήματα με ληγμένα πιστοποιητικά στο εσωτερικό δίκτυο του σχολείου.

---

## Συνοπτικό Διάγραμμα Ροής

1.  Ο χρήστης μπαίνει στο **WordPress** -> Το Chatbot λαμβάνει Ρόλο (Student/Teacher).
2.  Ο χρήστης ρωτάει "Νέα για εκδρομές" -> Το Chatbot ρωτάει το API του WordPress.
3.  Το WordPress απαντάει με άρθρα.
4.  Όλη η επικοινωνία περνάει μέσα από το **Nginx** και κρυπτογραφείται με **HTTPS**.

Αυτά τα τρία κομμάτια μετατρέπουν μια απλή εφαρμογή Python σε μια ολοκληρωμένη, διασυνδεδεμένη διαδικτυακή υπηρεσία.
