
import os

file_path = "data/nlu.yml"

# Correct content to append
correct_content = """
- intent: inform_role_student
  examples: |
    - Μαθητής
    - Μαθητης
    - μαθητής
    - μαθητης
    - ΜΑΘΗΤΗΣ
    - ειμαι μαθητης
    - είμαι μαθητής
    - ρόλος μαθητή
    - επιλέγω μαθητής
    - student

- intent: inform_role_parent
  examples: |
    - Γονέας
    - Γονεας
    - γονέας
    - γονεας
    - γονιος
    - γονιός
    - κηδεμόνας
    - κηδεμόνας
    - ειμαι γονεας
    - είμαι γονιός
    - ρόλος γονέα
    - parent

- intent: inform_role_teacher
  examples: |
    - εκπαιδευτικός
    - εκπαιδευτικος
    - Εκπαιδευτικός
    - Εκπαιδευτικος
    - ΕΚΠΑΙΔΕΥΤΙΚΟΣ
    - ΚΑΘΗΓΗΤΗΣ
    - καθηγητής
    - ειμαι εκπαιδευτικος
    - ρόλος καθηγητή
    - teacher

- intent: ask_study_material
  examples: |
    - δωσε υλικο για διαβασμα
    - θελω υλικό για διαβασμα
    - μπορω να εχω υλικο για διαβασμα
    - θα ηθελα υλικο για διαβασμα
    - Υλικό για Διάβασμα
    - υλικό για διάβασμα
    - θέλω να διαβάσω
    - δώσε μου κάτι να διαβάσω
    - έχεις σημειώσεις;
    - σημειώσεις για μάθημα
    - υλικο μελετης
    - ΘΕΛΩ ΥΛΙΚΟ ΓΙΑ ΔΙΑΒΑΣΜΑ
    - ΥΛΙΚΟ ΓΙΑ ΔΙΑΒΑΣΜΑ
    - ΔΩΣΕ ΜΟΥ ΥΛΙΚΟ ΓΙΑ ΔΙΑΒΑΣΜΑ
    - Δωσε υλικο να διαβασω
    - υλικοΟ
    - υπαρχει τιποτα για διαβασμα;
    - θελω να μελετησω
    - βρες μου καμια σημειωση
    - ψαχνω υλικο για μαθηματικα
    - θελω να δω τι υλικο υπαρχει
    - δειξε μου σημειωσεις
    - διαβασμα
    - διάβασμα
    - ΔΙΑΒΑΣΜΑ
    - θελω διαβασμα
    - υλικο για μελετη
    - βοηθηματα
    - ασκησεις για διαβασμα
    - θελω να κανω επαναληψη
    - υπαρχει υλικο για διαβασμα;
    - θελω να προετοιμαστω για εξετασεις
    - που θα βρω σημειωσεις
    - δωσε μου σημειωσεις
    - εχεις ασκησεις;
    - θέλω να βρω υλικό για ανάγνωση
    - Θέλω υλικό για ανάγνωση
    - Θέλω να βρω υλικό για μελέτη
    - Θέλω υλικό για μελέτη
    - υλικό για ανάγνωση
    - υλικό για μελέτη
    - Δώσε μου υλικό για μελέτη
    - Δώσε μου υλικό για ανάγνωση
    - Πως μπορώ να βρω υλικό για μελέτη
    - Πως μπορώ να βρω υλικό για ανάγνωση
    - Πού μπορώ να βρω το υλικό για διάβασμα;
    - Έχει ανέβει υλικό μελέτης;
    - Μπορείς να μου δείξεις τις σημειώσεις;
    - Πού βρίσκω το υλικό που έδωσε ο καθηγητής;
    - Υπάρχει υλικό για επανάληψη;
    - Έχει ασκήσεις για εξάσκηση;
    - Πού μπορώ να κατεβάσω το υλικό;
    - Υπάρχει βοηθητικό υλικό για το διάβασμα;
    - Έχει αναρτηθεί νέο υλικό;
    - Μπορώ να δω παλιό υλικό μελέτης;
"""

try:
    with open(file_path, "r", encoding="utf-8", errors="ignore") as f:
        content = f.read()
    
    # Locate where the corruption usually starts (the added intents)
    # We look for the first occurrence of "inform_role_student" and truncate before it
    marker = "- intent: inform_role_student"
    idx = content.find(marker)
    
    if idx != -1:
        print(f"Found marker at index {idx}. Truncating and rewriting...")
        new_content = content[:idx] + correct_content
    else:
        print("Marker not found. Appending to end...")
        new_content = content + "\n" + correct_content
        
    with open(file_path, "w", encoding="utf-8") as f:
        f.write(new_content)
        
    print("Fix applied successfully.")

except Exception as e:
    print(f"Error: {e}")
